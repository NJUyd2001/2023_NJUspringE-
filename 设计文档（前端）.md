

[TOC]

# 设计文档（前端）

### 

##  一. 代码结构

### （一）登录、注册设计

#### 	 1. 主界面

​			路径：http://localhost:9090/#/home（本地路径）。vue部分代码设计与主页部分类似，在主页设计部分中我会详细的介绍。在main中，包含两个card，第一个card可直接跳转到客户登录，第二个card可直接跳转到工作人员登录。在设计中，我把用户登录和工作人员登录做了分离。首先，把二者分开可以在一定程度上提高安全性；其二，在设计中，工作人员的账号只能由管理员来注册，而客户的账号则由自己注册，所以在设计中二者也存在差异。综上，我决定把这两个登录界面分开，也能更好的体现结构

![](pic\image-20230716112337440.png)

#### 	 2. 登录界面

​			登录界面包括客户登录和工作人员登录。用户可以通过输入用户名和用户密码登录相应的主页。如果希望注册界面，客户可以直接点击注册以完成注册，而工作人员需要向管理员发起申请。在输入的账户信息匹配成功后，登录函数会把该用户的全部个人信息都保存到this.$store.state.user中，留在日后备用。

![](pic\image-20230716114252565.png)

#### 3. 注册界面

​		在客户注册时，客户需要提供的信息有：用户名（不可重复），账户密码，联系方式（不可重复）和用户邮箱（不可重复）。在输入完密码之后需要再次输入密码，两次需要完全相同才可以完成注册。用户输入的全部个人信息都会储存到ruleForm中并传给数据库，注册成功后会自动跳转到登录界面。工作人员的注册只能由管理员完成。与客户注册不同的是，管理员需要选择注册用户的工作，包括：市场部人员，测试部人员，质量部人员，测试部主管和授权签字人。除此之外与客户注册的流程相同。注册成功后，会返回管理员主页。

![](pic\image-20230716115534536.png)

### （二）主页设计

####       1.el-container（主容器）

​         代码的vue部分由el-container负责布局。最外层为el-container,里面包含了el-header与el-container，两个子容器垂直排列。

![](pic\image-20230715195526478.png)

#### 		(1) el-header

​          header中只有一个el-row,该row中包含了三个el-col，它们分别储存了标头，logo和按钮。其中，标头的格式为【用户名】，您好。该格式在全部用户界面中使用，包括：客户主页，市场部主页，测试部主页，测试部主管主页，质量部主页，授权签字人主页和管理员主页。第二部分为logo，logo内容为南京大学软件测试中心，格式为.png，该格式同样适用于全部的用户界面，除去上部分的范围，还有网站主页、用户登录，工作人员登录，与注册界面。第三部分为按钮，包括了个人中心按钮以及登出按钮。其中，点击个人中心按钮会进入个人中心，在个人中心可完成个人信息查看和个人信息修改。点击登出按钮可以跳转回该用户所属用户类型对应的登录界面。

![](pic\image-20230715200340131.png)

#### 		(2) el-container （子容器）

​			该容器包含el-aside与el-container,el-aside是左侧导航栏部分，导航栏包含了一个el-menu,el-menu中包含了数个submenu，每个submenu都可以折叠，在这里存放了该用户的一个主要功能，submenu中同样细化了多个el-menu-item-group，每一个都对应了一项具体的功能，当用户需要使用时可点击该按钮，会在右侧的el-main中打开一个新的table，帮助用户完成工作。除了打开新的table，还有部分功能会打开新的界面以实现功能。这包括：客户发起委托，全部用户完善个人信息。

#### 		(3) el-main

​			main中只有一个el-tabs，当用户需要完成某项工作时，会在左侧导航栏点击相应内容，便会在main出显示出相应的表格，由于工作的单位是单个委托，所以该表格的搜索项就是委托的state（委托的当前状态，即进行到哪部分），根据state确定委托的PID，并把需要的内容打印出来，打印内容：委托ID，进程ID，委托名称，委托发起时间，测试类型与用户ID。

![](pic\image-20230715203641651.png)

#### 		(4) el-footer

​			el-footer的格式如下面所示，只包含一个<p>,其中第一行是“南京大学 计算机软件新技术国家重点实验室 软件测试中心”，第二行是“江苏省 南京市 栖霞区 仙林大道163号南京大学仙林校区计算机科学与技术楼”

![](pic\image-20230715203909072.png)

#### 	  2. script部分

#### 		(1) created()

​			除去包含beforecreated()的文件外，created函数是首先执行的函数。所以，页面中显示的后端数据，自然也要在created中调取。除了初始化的数据外，created还可以防止刷新数据丢失，实现函数为KeepInfor()。

![](pic\image-20230716103406002.png)

#### 		(2) data()

​			data()中存放了全部的数据结构，比如储存从后端调取的数据，用户在网页输入的数据或一些必要的状态和检索值。储存时不能弄混数据结构的类型。例如：

![](pic\image-20230716104142142.png)

#### 		(3) 其他函数

​			其他函数功能繁杂，类型众多，就不在手册中一一赘述。他们的功能是实现该文件所需要完成的任务，处理从网页或后端接口获取的数据，并转化为需要的接口并传给需要的位置。

#### 	 3. style部分

​			该部分为css代码段，其功能是网页布局设计和美化。值得注意的是，在命名是要尽量不和其他文件设一个名字。如果设了同一个名字，也要保证这些数据完全相同，否则由于文件之间并不完全平等的关系，会导致本文件的style采用的是比它优先级跟高的文件里的同名style，从而导致在设计布局上出现意想不到的bug。除此之外，该部分的设计几乎没有技术上的难度，可以通过实际显示情况进行不断地微调。

### （三）tabs部分设计

​				由于该项目的单位是委托，所以用户主界面所有的单位都是委托，其中搜索依据是state。state的作用是记录该委托当前的状态，即已经进行到哪一步。具体的数值如下：

发起委托(委托修改) 10  市场部通过 11 测试部不通过 15  测试部通过 12 不通过 16   生成报价 20  客户接受报价 21 不接受 25

生成合同草稿 30  客户接受并填写合同 31 不接受 35    市场部审核通过 32 不通过36

用户发送样品 40  验收通过 41 不通过 45  测试部编写测试方案 50  质量部通过 51 不通过 55

填写测试文档 60  测试完成，生成测试报告 70  测试部主管通过 71 不通过 75  用户审核通过 72 不通过76  授权签字人 73 77

测试部归档 发送测试报告 80  确认接受 81

​	在相应的按钮下，代码会根据相应的state来寻找全部进程，再根据这些进程的ID找到委托的具体信息。点击导航栏的按钮后，会调用addtab()函数：

![](pic\image-20230716134217268.png)

调用后，该tabs的名称是targetName值，需要调用的vue文件是commentName，全部的文件格式都是表格，表格中列出了需要被处理委托的基本信息，格式如下：

![](pic\image-20230716134453983.png)

用户可以点击操作栏下的处理按钮进入到具体的执行页面

## 	二. 接口设计

### （一） 从后端接收数据

#### 	1.通过state确定PID

​	从后端获得数据的主要方式为checkbyPID。首先通过指定state，找到所有符合条件的PID，其中储存state的数据结构为：

![](pic\image-20230716135927909.png)

从后端传回的数据在ret.data中，如果需要打印到前端，则把数据存到ruleForm中。在本步骤中，返回的值为数组，数组中的内容为全部相应state的委托的PID，把对应委托的信息储存到ruleForm并且显示在tabs的表格中。

#### 	2. 通过state，FileType与PID确定FID

​		当需要下载文件时，为了可以做到精准的确定文件，我们首先需要PID确定是来自哪一个委托的文件，确定委托后，再确定来自哪一步，即state值，该state在file类中，与上一部分的state并不相同。确定了具体的位置后，还有确定是哪一个具体的文件，比如，在发起委托时，需要同时上传需求文档，用户文档和操作文档。FileType的功能就是确定同一个state下的多个文件各个的功能。具体的代码如下：

![](pic\image-20230716142511630.png)

#### 	3. 通过find()查找

​			如果需要根据特定的ID寻找委托，那么可以用一系列的find函数实现。比如，通过state是findbystate，通过UID是findByUID，通过PID是findByPID，通过AID是findByAID。这些函数的返回值都是数组，里面存了全部符合条件的委托的信息。

![](pic\image-20230716144557992.png)

### （二）向后端传输数据

####   1. 从网页中获取

​		对于用户传输的数据，代码中会传到ruleForm中，无论是从后端传到网页，还是从网页传到后端，都是通过ruleForm来传输。绝大部分的文件都是单向传输，但也有少量文件，如修改界面，也会出现双向传输的界面。向后端传输时，一般时通过点击提交按钮后，在submitForm函数中实现传输，示例如下：

![](pic\image-20230716143131317.png)

####   2. 使用接口

#### 		(1) insert()

​		如果该网页所传输的数据在此之前从没有被传到数据库中，那么调用insert函数即可，insert中保存了全部的数据，还要加上当前委托的PID，示例如下：

![](pic\image-20230716143456300.png)

#### 		(2) update()

​			如果前一步的方案被否决，那么需要用户修改方案，在界面中会把之前不通过的信息全部打印出来，并且允许用户进行修改，在用户修改完成后，点击完成按钮会调用submitform函数，函数中包含update函数，该函数可更改数据库中的数据，而修改的数据同样储存在ruleForm中，示例如下：

![](pic\image-20230716144033276.png)





